version: "3.8"

services:
  controlcenter:
    build: .
    ports:
      - "5000:5000"
    volumes:
      # DB stored next to docker-compose.yml, not in a Docker volume
      - ./data:/app/data
      # Agent and bootstrap scripts served via API for download
      - ./agent:/app/agent:ro
      - ./bootstrap.sh:/app/bootstrap.sh:ro
    working_dir: /app
    environment:
      - SECRET_KEY=changeme-in-production
      - JWT_SECRET_KEY=jwt-changeme-in-production
      # SQLite is built into Python â€” no separate DB image needed.
      # The .db file is stored in ./data/ alongside docker-compose.yml.
      - DATABASE_URL=sqlite:////app/data/sshadmin.db
    restart: unless-stopped
